# Estructura del Proyecto - Sistema de Productos Descontinuados

## Diagrama de Capas

```
???????????????????????????????????????????
?      PRESENTACIÓN (UI)    ?
?  ?????????????????????????????????????  ?
?  ?     FrmLista.cs   ?  ?  ??? Interfaz de Usuario
?  ? - dgvProductos (DataGridView)     ?  ?
?  ? - btnDescontinuar       ?  ?
?  ? - txtBarras   ?  ?
?  ?????????????????????????????????????  ?
???????????????????????????????????????????
     ?
???????????????????????????????????????????
?       SERVICIOS (Business Logic)     ?
?  ?????????????????????????????????????  ?
?  ?  clsServicioProductos.cs          ?  ? ??? Lógica de negocio
?  ? - BuscarYSeleccionar()            ?  ?
?? - DescontinuarYRecargar()         ?  ?
?  ? - RecargarDataGridView()     ?  ?
?  ? - ObtenerProductoSeleccionado()   ?  ?
?  ?????????????????????????????????????  ?
???????????????????????????????????????????
        ?
???????????????????????????????????????????
?  DATOS (Data Access Layer)        ?
?  ?????????????????????????????????????  ?
?  ?  clsDaoProductos.cs   ?  ? ??? Consultas a BD
?  ? - ObtenerTodosProductos()  ?  ?
?  ? - ObtenerProductosActivos()  ?  ?
?  ? - ObtenerProductoPorCodigo()      ?  ?
?  ? - DescontinuarProducto()      ?  ?
?  ?????????????????????????????????????  ?
?  ?????????????????????????????????????  ?
?  ?  clsConexion.cs       ?  ? ??? Conexión a BD
?  ? - AbrirConexion()       ?  ?
?  ? - CerrarConexion() ?  ?
?  ? - ObtenerConexion()         ?  ?
?  ?????????????????????????????????????  ?
?  ?????????????????????????????????????  ?
?  ?  clsLlenarDataGridView.cs        ?  ? ??? Helper UI
?  ? - LlenarProductos()     ?  ?
?  ? - LimpiarDataGridView()       ?  ?
?  ?????????????????????????????????????  ?
???????????????????????????????????????????
    ?
???????????????????????????????????????????
?      MODELOS (POJOs)     ?
?  ?????????????????????????????????????  ?
?  ?  clsProductos.cs                  ?  ? ??? Clase modelo
?  ? - idProducto ?  ?
?  ? - nombreProducto    ?  ?
?  ? - cantidad         ?  ?
?  ? - precio ?  ?
?  ? - categoria       ?  ?
?  ? - oferta             ?  ?
?  ? - descontinuado       ?  ?
?  ? - codigoBarras     ?  ?
?  ??????????????????????????????????????
???????????????????????????????????????????
    ?
???????????????????????????????????????????
?     BASE DE DATOS (SQL Server)          ?
?  ?????????????????????????????????????  ?
?  ?  Tabla: Productos?  ?
?  ? - idProducto (PK)           ?  ?
?  ? - nombreProducto        ?  ?
?  ? - cantidad      ?  ?
?  ? - precio            ?  ?
?  ? - categoria   ?  ?
?  ? - oferta        ?  ?
?  ? - descontinuado  ?  ?
?  ? - codigoBarras (UNIQUE)           ?  ?
?  ?????????????????????????????????????  ?
???????????????????????????????????????????
```

## Estructura de Directorios

```
proyectoBddescontinuado/
?
??? Properties/
?   ??? AssemblyInfo.cs
?   ??? Resources.Designer.cs
?   ??? Settings.Designer.cs
?
??? Clases/
?   ??? Producto.cs  (Clase antigua - se puede eliminar)
?
??? DATOS/
?   ??? clsConexion.cs        ???? Gestiona conexiones SQL
?   ??? clsDaoProductos.cs      ???? Acceso a datos
?   ??? clsLlenarDataGridView.cs ???? Helper para UI
?
??? POJOS/
?   ??? clsProductos.cs         ???? Modelo de datos
?
??? SERVICIOS/
? ??? clsServicioProductos.cs ???? Lógica de negocio
?
??? FrmLista.cs     ???? Formulario principal
??? FrmLista.Designer.cs        ???? Diseño del formulario
??? FrmLista.resx  ???? Recursos del formulario
?
??? Program.cs           ???? Punto de entrada
?
??? App.config      ???? Configuración
?
??? CONFIGURACION.md        ???? Guía de configuración
??? EJEMPLOS_USO.md         ???? Ejemplos de código
```

## Flujo de Datos

### 1. Cargar Productos

```
FrmLista (Load)
    ?
CargarProductos()
    ?
clsDaoProductos.ObtenerProductosActivos()
    ?
clsConexion.AbrirConexion()
    ?
SqlCommand (SELECT * FROM Productos WHERE descontinuado = 0)
    ?
SqlDataReader (Lee datos)
    ?
clsProductos List (Crea objetos)
    ?
clsLlenarDataGridView.LlenarProductos()
    ?
dgvProductos (Muestra datos)
```

### 2. Buscar por Código de Barras

```
txtBarras_KeyUp (Enter)
    ?
clsDaoProductos.ObtenerProductoPorCodigo(codigo)
    ?
clsConexion.AbrirConexion()
    ?
SqlCommand (SELECT * FROM Productos WHERE codigoBarras = @codigo)
    ?
clsProductos (Retorna objeto)
    ?
Busca en dgvProductos y selecciona la fila
```

### 3. Descontinuar Producto

```
btnDescontinuar_Click (Con producto seleccionado)
    ?
Confirmación (MessageBox)
    ?
clsDaoProductos.DescontinuarProducto(idProducto)
    ?
clsConexion.AbrirConexion()
    ?
SqlCommand (UPDATE Productos SET descontinuado = 1)
    ?
bool resultado
    ?
CargarProductos() (Recarga)
    ?
dgvProductos (Actualiza vista)
```

## Clases y Responsabilidades

| Clase | Responsabilidad | Namespace |
|-------|-----------------|-----------|
| **FrmLista** | Interfaz de usuario, eventos | proyectoBddescontinuado |
| **clsConexion** | Abrir/Cerrar conexión SQL | DATOS |
| **clsDaoProductos** | CRUD de productos | DATOS |
| **clsLlenarDataGridView** | Llenar controles DataGridView | DATOS |
| **clsProductos** | Modelo de producto | POJOS |
| **clsServicioProductos** | Lógica de negocio | SERVICIOS |

## Métodos Principales por Clase

### clsDaoProductos
- `ObtenerTodosProductos()` ? List<clsProductos>
- `ObtenerProductosActivos()` ? List<clsProductos>
- `ObtenerProductoPorCodigo(codigo)` ? clsProductos
- `DescontinuarProducto(idProducto)` ? bool

### clsConexion
- `AbrirConexion()` ? bool
- `CerrarConexion()` ? bool
- `ObtenerConexion()` ? SqlConnection
- `EstablecerCadenaConexion(cadena)` ? void

### clsServicioProductos
- `BuscarYSeleccionarProducto(dgv, codigo)` ? bool
- `DescontinuarYRecargar(dgv, idProducto)` ? bool
- `RecargarDataGridView(dgv)` ? void
- `ObtenerIdProductoSeleccionado(dgv)` ? int
- `ObtenerProductoSeleccionado(dgv)` ? clsProductos
- `ValidarProductoExistente(codigo)` ? clsProductos

## Ventajas de esta Arquitectura

? **Separación de Responsabilidades**: Cada clase tiene un propósito específico
? **Reutilizable**: Las clases de datos se pueden usar en otros formularios
? **Mantenible**: Cambios en BD solo afectan la capa DATOS
? **Testeable**: Fácil de crear pruebas unitarias
? **Escalable**: Se pueden agregar nuevas features sin afectar código existente
? **Segura**: Usa parámetros en queries (previene SQL injection)

## Próximos Pasos Recomendados

1. ? Configurar cadena de conexión
2. ? Crear tabla en BD
3. ? Insertar datos de prueba
4. ? Compilar y ejecutar
5. ?? Agregar validaciones adicionales
6. ?? Implementar búsqueda por filtros
7. ?? Agregar edición de productos
8. ?? Implementar reportes
